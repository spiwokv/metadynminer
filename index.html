<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools to Read, Analyze and Visualize Metadynamics HILLS Files from Plumed • metadynminer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tools to Read, Analyze and Visualize Metadynamics HILLS Files from Plumed">
<meta property="og:description" content="Metadynamics is a state of the art biomolecular simulation technique.
  Plumed Tribello, G.A. et al. (2014) &lt;doi:10.1016/j.cpc.2013.09.018&gt; program makes
  it possible to perform metadynamics using various simulation codes. The results of
  metadynamics done in Plumed can be analyzed by metadynminer. The package
  metadynminer reads 1D and 2D metadynamics hills files from Plumed package.
  It uses a fast algorithm by Hosek, P. and Spiwok, V. (2016) &lt;doi:10.1016/j.cpc.2015.08.037&gt;
  to calculate a free energy surface from hills. Minima can be located and plotted on
  the free energy surface. Transition states can be analyzed by Nudged Elastic Band
  method by Henkelman, G. and Jonsson, H. (2000) &lt;doi:10.1063/1.1323224&gt;. Free energy
  surfaces, minima and transition paths can be plotted to produce publication quality
  images.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">metadynminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="metadynminer">MetadynMiner<a class="anchor" aria-label="anchor" href="#metadynminer"></a>
</h1></div>
<div class="section level2">
<h2 id="web-site">Web site<a class="anchor" aria-label="anchor" href="#web-site"></a>
</h2>
<p><a href="http://metadynamics.cz/metadynminer/" class="external-link uri">http://metadynamics.cz/metadynminer/</a></p>
<p><a href="https://spiwokv.github.io/metadynminer/" class="external-link uri">https://spiwokv.github.io/metadynminer/</a> (<a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> web)</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>MetadynMiner is R packages for reading, analysis and visualization of metadynamics HILLS files produced by Plumed. It reads HILLS files from Plumed, calculates free energy surface by fast Bias Sum algorithm, finds minima and analyses transition paths by Nudged Elastic Band method.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install from R repository</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"metadynminer"</span><span class="op">)</span>

<span class="co"># Install from GitHub by devtools</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"spiwokv/metadynminer"</span><span class="op">)</span>

<span class="co"># Load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.metadynamics.cz/metadynminer" class="external-link">metadynminer</a></span><span class="op">)</span>
<span class="co"># Read hills file</span>
<span class="va">hillsf</span><span class="op">&lt;-</span><span class="fu"><a href="reference/read.hills.html">read.hills</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># HILLS with periodicity on CV1 and CV2</span>

<span class="co"># Sum two hills files</span>
<span class="va">hillsf</span><span class="op">+</span><span class="va">hillsf</span>

<span class="co"># Summary of a hills file</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>

<span class="co"># Plot CVs</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/hills2d.png" alt=""><p class="caption">hills2d</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot heights</span>
<span class="fu"><a href="reference/plotheights.html">plotheights</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/hills2dh.png" alt=""><p class="caption">hills2dh</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate FES by bias sum (alternatively use fes2 for conventional calculation)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>

<span class="co"># Calculate FES for given range (indexes of hills)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span>, imin<span class="op">=</span><span class="fl">5000</span>, imax<span class="op">=</span><span class="fl">10000</span><span class="op">)</span>

<span class="co"># Sum two FESes</span>
<span class="va">tfes</span><span class="op">+</span><span class="va">tfes</span>

<span class="co"># Calculate and subtract min, max or mean from a FES</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="va">tfes</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Summary of FES</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Plot FES</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/fes2d.png" alt=""><p class="caption">fes2d</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot FES with color scale</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, colscale<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/fes2d3.png" alt=""><p class="caption">fes2d3</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find minima</span>
<span class="va">minima</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fesminima.html">fesminima</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>

<span class="co"># Summary of minima</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span>

<span class="co"># Create empty minima list, create ad hoc minimum, add minima</span>
<span class="va">minima</span><span class="op">&lt;-</span><span class="fu"><a href="reference/oneminimum.html">oneminimum</a></span><span class="op">(</span><span class="va">tfes</span>, cv1<span class="op">=</span><span class="fl">0</span>, cv2<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="reference/fesminima.html">fesminima</a></span><span class="op">(</span><span class="va">fes</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="reference/oneminimum.html">oneminimum</a></span><span class="op">(</span><span class="va">tfes</span>, cv1<span class="op">=</span><span class="fl">0</span>, cv2<span class="op">=</span><span class="fl">0</span><span class="op">)</span>

<span class="co"># Plot free energy minima</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/min2d.png" alt=""><p class="caption">min2d</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate free energy profile for minima</span>
<span class="va">prof</span><span class="op">&lt;-</span><span class="fu"><a href="reference/feprof.html">feprof</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span>

<span class="co"># Plot free energy profile for minima</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prof</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/prof2d.png" alt=""><p class="caption">prof2d</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Make 1D free energy surface from the 2D one</span>
<span class="va">tfes1</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes2d21d.html">fes2d21d</a></span><span class="op">(</span><span class="va">hillsf</span>, remdim<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># T=300K, kJ/mol</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes1</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/fes1d.png" alt=""><p class="caption">fes1d</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate transition path using Nudged Elastic Band</span>
<span class="va">myneb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/neb.html">neb</a></span><span class="op">(</span><span class="va">minima</span>, min1<span class="op">=</span><span class="st">"A"</span>, min2<span class="op">=</span><span class="st">"B"</span><span class="op">)</span>
<span class="va">myneb</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myneb</span><span class="op">)</span>

<span class="co"># Plot transition path</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myneb</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/neb1.png" alt=""><p class="caption">neb1</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot transition path on FES</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">minima</span><span class="op">)</span>
<span class="fu"><a href="reference/linesonfes.html">linesonfes</a></span><span class="op">(</span><span class="va">myneb</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/neb2.png" alt=""><p class="caption">neb2</p>
</div>
</div>
<div class="section level2">
<h2 id="tips-and-tricks">Tips and Tricks<a class="anchor" aria-label="anchor" href="#tips-and-tricks"></a>
</h2>
<div class="section level3">
<h3 id="publication-quality-figures">Publication quality figures<a class="anchor" aria-label="anchor" href="#publication-quality-figures"></a>
</h3>
<p>Following script can be used to generate a publication quality figure (8x8 cm, 600 dpi):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hillsf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read.hills.html">read.hills</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>,<span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="st">"filename.png"</span>, height<span class="op">=</span><span class="fl">8</span>, width<span class="op">=</span><span class="fl">8</span>, units<span class="op">=</span><span class="st">'cm'</span>, res<span class="op">=</span><span class="fl">600</span>, pointsize<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><a href="./figs/fes2dq.png">Image</a></p>
</div>
<div class="section level3">
<h3 id="making-fes-relative-to-the-global-minimum">Making FES relative to the global minimum<a class="anchor" aria-label="anchor" href="#making-fes-relative-to-the-global-minimum"></a>
</h3>
<p>You can set free energy minimum to zero by typing:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfes</span> <span class="op">&lt;-</span> <span class="va">tfes</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hills-from-restarted-simulations">Hills from restarted simulations<a class="anchor" aria-label="anchor" href="#hills-from-restarted-simulations"></a>
</h3>
<p>There are two ways to cope with hills file from restarted simulations, i.e. simulations where the time column starts from zero at every restart. It is possible to set <code>ignoretime=T</code> in the <code>read.hills</code> function. It will take the time of the first hill and use it as the uniform step.</p>
<p>Alternatively, it is possible to use <code>ignoretime=T</code> for other ploting functions.</p>
<p>MetadynMiner does not support hills files with variable PACE.</p>
</div>
<div class="section level3">
<h3 id="making-movie">Making movie<a class="anchor" aria-label="anchor" href="#making-movie"></a>
</h3>
<p>Individual snapshots of a movie can be generated and concatenated by:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("magick") &lt;- install before the first run</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.metadynamics.cz/metadynminer" class="external-link">metadynminer</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span>
<span class="va">odir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"frames"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">odir</span>, recursive<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">hillsf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read.hills.html">read.hills</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>,<span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span>, imax<span class="op">=</span><span class="fl">300</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">odir</span>, <span class="st">"/snap%04d.png"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tfes</span><span class="op">&lt;-</span><span class="va">tfes</span><span class="op">+</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span>, imin<span class="op">=</span><span class="fl">300</span><span class="op">*</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>, imax<span class="op">=</span><span class="fl">300</span><span class="op">*</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">figs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">odir</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">rfigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">figs</span>, <span class="va">image_read</span><span class="op">)</span>
<span class="va">allfigs</span> <span class="op">&lt;-</span> <span class="fu">image_join</span><span class="op">(</span><span class="va">rfigs</span><span class="op">)</span>
<span class="va">anim</span> <span class="op">&lt;-</span> <span class="fu">image_animate</span><span class="op">(</span><span class="va">allfigs</span>, fps<span class="op">=</span><span class="fl">25</span><span class="op">)</span>
<span class="fu">image_write</span><span class="op">(</span>image<span class="op">=</span><span class="va">anim</span>, path<span class="op">=</span><span class="st">"anim.gif"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/anim.gif" alt=""><p class="caption">anim1</p>
</div>
<p>Package <a href="https://github.com/ropensci/magick" class="external-link">magick</a> was used. Alternatively, files can be concatenated by outside R by any movie making program.</p>
<p>If you instead want to see flooding, type:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#install.packages("magick") &lt;- install before the first run</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.metadynamics.cz/metadynminer" class="external-link">metadynminer</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span>
<span class="va">odir</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"frames"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">odir</span>, recursive<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">hillsf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read.hills.html">read.hills</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>,<span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">odir</span>, <span class="st">"/snap%04d.png"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tfes</span><span class="op">&lt;-</span><span class="va">tfes</span> <span class="op">+</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">hillsf</span>, imin<span class="op">=</span><span class="fl">300</span><span class="op">*</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>, imax<span class="op">=</span><span class="fl">300</span><span class="op">*</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">figs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">odir</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">rfigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">figs</span>, <span class="va">image_read</span><span class="op">)</span>
<span class="va">allfigs</span> <span class="op">&lt;-</span> <span class="fu">image_join</span><span class="op">(</span><span class="va">rfigs</span><span class="op">)</span>
<span class="va">anim</span> <span class="op">&lt;-</span> <span class="fu">image_animate</span><span class="op">(</span><span class="va">allfigs</span>, fps<span class="op">=</span><span class="fl">25</span><span class="op">)</span>
<span class="fu">image_write</span><span class="op">(</span>image<span class="op">=</span><span class="va">anim</span>, path<span class="op">=</span><span class="st">"flooding.gif"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/flooding.gif" alt=""><p class="caption">anim2</p>
</div>
</div>
<div class="section level3">
<h3 id="evaluation-of-convergence-of-one-cv">Evaluation of convergence of one CV<a class="anchor" aria-label="anchor" href="#evaluation-of-convergence-of-one-cv"></a>
</h3>
<p>You can use function <code>fes2d21d</code> to convert a 2D surface to 1D and to evaluate the evolution:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hillsf</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read.hills.html">read.hills</a></span><span class="op">(</span><span class="st">"HILLS"</span>, per<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">T</span>,<span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfes1</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes2d21d.html">fes2d21d</a></span><span class="op">(</span><span class="va">hillsf</span>, remdim<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tfes1</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">80</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">4</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">tfes1</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes2d21d.html">fes2d21d</a></span><span class="op">(</span><span class="va">hillsf</span>, imax<span class="op">=</span><span class="fl">3000</span><span class="op">*</span><span class="va">i</span><span class="op">)</span>
 <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">tfes1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tfes1</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="figure">
<img src="./figs/evol1d.png" alt=""><p class="caption">evol1d</p>
</div>
</div>
<div class="section level3">
<h3 id="transforming-cvs">Transforming CVs<a class="anchor" aria-label="anchor" href="#transforming-cvs"></a>
</h3>
<p>If you want to use degrees instead of radians on axes, set <code>axes=F</code> in the plot function and then plot (without closing the plot window!) both axes separately.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span>, axes<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">3</span>, labels<span class="op">=</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">3</span>, labels<span class="op">=</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span><span class="op">*</span><span class="fl">60</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/degs.png" alt=""><p class="caption">degs</p>
</div>
<p>The expression -3:3 will generate a vector {-3,-2,-1,0,1,2,3}, which can be multiplied by pi/3 (tick positions in radians) or by 60 (tick positions in degrees). If you want to transform just one axis, e.g. the horizontal one while keeping the vertical unchanged, simply type <code>axis(2)</code> for the vertical one. <code><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box()</a></code> redraws a box.</p>
</div>
<div class="section level3">
<h3 id="kcal-vs-kj">kcal vs kJ<a class="anchor" aria-label="anchor" href="#kcal-vs-kj"></a>
</h3>
<p>MetadynMiner works in kJ/mol by defauls. If your MD engine uses kcal/mol instead, you can either multiply your free energy surface by 4.184 to get kJ/mol. If you prefer to keep kcal/mol, you can set <code>eunit="kcal/mol"</code> for functions <code>fes2d21d</code> or <code>summary</code> of minima object. Other units are not supported.</p>
</div>
<div class="section level3">
<h3 id="shifting-a-periodic-cv">Shifting a periodic CV<a class="anchor" aria-label="anchor" href="#shifting-a-periodic-cv"></a>
</h3>
<p>It may happen that some simulations with a torsion CV it may be difficult to analyze and visualize it in the range -pi - +pi. However, this problem is not very common so we did not make any user friendly way how to solve this and it can be solved in a user unfriendly way. Let us consider we want to shift the first collective variable to be in the range 0 - 2pi. First we will make copy of acealanme. We will change its <code>pcv1</code> to <code>c(0,2*pi)</code>. Finally we can add 2pi to the first collective variable:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acealanmec</span><span class="op">&lt;-</span><span class="va">acealanme</span>
<span class="va">acealanmec</span><span class="op">$</span><span class="va">pcv1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span>
<span class="va">acealanmec</span><span class="op">$</span><span class="va">hillsfile</span><span class="op">[</span><span class="va">acealanmec</span><span class="op">$</span><span class="va">hillsfile</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span>
    <span class="va">acealanmec</span><span class="op">$</span><span class="va">hillsfile</span><span class="op">[</span><span class="va">acealanmec</span><span class="op">$</span><span class="va">hillsfile</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span>
<span class="va">tfes</span><span class="op">&lt;-</span><span class="fu"><a href="reference/fes.html">fes</a></span><span class="op">(</span><span class="va">acealanmec</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tfes</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="./figs/shift.png" alt=""><p class="caption">shift</p>
</div>
<p>The hills file object has several instances including <code>hillsfile</code>, which contains the HILLS file, and <code>pcv1</code> with collective variable periodicity. They can be printed by <code>$</code> operator. The expression <code>acealanmec$hillsfile[,2]</code> prints all values of the first collective variable. The expression <code>acealanmec$hillsfile[,2]&lt;0</code> prints the same number of <code>TRUE</code> or <code>FALSE</code> values depending whether the first collective variable is positive or negative. The expression <code>acealanmec$hillsfile[acealanmec$hillsfile[,2]&lt;0,2]</code> prints only negative values of the first collective variable. They can be replaced by the same value + 2pi.</p>
</div>
</div>
<div class="section level2">
<h2 id="training">Training<a class="anchor" aria-label="anchor" href="#training"></a>
</h2>
<p><a href="https://youtu.be/W8N-G8d0or4" class="external-link">MetadynMiner Webinar video</a></p>
<p><a href="https://www.plumed.org/doc-master/user-doc/html/masterclass-22-02.html" class="external-link">Plumed Masterclass tutorial</a></p>
<p><a href="https://youtu.be/T8a-kP6V3_g" class="external-link">Plumed Masterclass video 1</a></p>
<p><a href="https://youtu.be/q1D39A_LQag" class="external-link">Plumed Masterclass video 2</a></p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Vojtech Spiwok - spiwokv{youknowwhat}vscht.cz</p>
<p>To contribute, se <a href="./CONTRIBUTING.html">CONTRIBUTING.md</a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=metadynminer" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metadynminer</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Vojtech Spiwok <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8108-2033" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/spiwokv/metadynminer/actions/" class="external-link"><img src="https://github.com/spiwokv/metadynminer/actions/workflows/check-standard.yaml/badge.svg" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/spiwokv/metadynminer" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/spiwokv/metadynminer?branch=master&amp;svg=true" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=metadynminer" class="external-link"><img src="https://www.r-pkg.org/badges/version/metadynminer" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=metadynminer" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/metadynminer" alt="CRAN downloads"></a></li>
<li><a href="http://www.rdocumentation.org/packages/metadynminer" class="external-link"><img src="http://api.rdocumentation.org/badges/version/metadynminer" alt="Rdoc"></a></li>
<li><a href="https://codecov.io/gh/spiwokv/metadynminer/" class="external-link"><img src="https://codecov.io/gh/spiwokv/metadynminer/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Vojtech Spiwok.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
